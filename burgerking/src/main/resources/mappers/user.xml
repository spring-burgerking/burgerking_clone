<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.springboot.burgerking.domain.auth.AuthRepository">
  
  	<insert id="noneMemberSignup" parameterType="com.springboot.burgerking.domain.auth.NoneMemberMst">
  		insert into
  			none_member_mst
  		values(
  			0,
  			#{name},
  			#{phone},
  			#{order_password}
  		)
  	</insert>
  	
  	<select id="noneMemberSignin" resultType="com.springboot.burgerking.domain.auth.NoneMemberMst">
  		select
  			id,
  			name,
  			phone,
  			order_password
  		from
  			none_member_mst
  		where
  			phone = #{phone}
  		
  	</select>
  	
  	<insert id="userAgreement" parameterType="com.springboot.burgerking.domain.auth.AgreementEntity">
  		insert into
  			agreement_check
  		values(
  			0,
  			#{user_id},
  			#{terms},
  			#{privacy_policy},
  			#{email_agreement},
  			#{sms_agreement}
  		)
  	</insert>
  	
  	<select id="checkUsername" parameterType="String" resultType="Integer">
  		select
  			count(email)
  		from
  			user_mst
  		where
  			email = #{email}
  	</select>
  	
  	<select id="selectPassword" parameterType="String" resultType="String">
  		select
  			password
  		from
  			user_mst
  		where
  			email = #{email}
  	</select>
  	
  	<select id="loadUserByEmail" parameterType="String" resultType="com.springboot.burgerking.domain.auth.User">
  		select
  			id,
			email,
			name,
			phone,
			gender,
			birth_year,
			birth_month,
			birth_date,
			password,
			create_date,
			update_date
  		from
  			user_mst
  		where
  			email = #{email}
  	</select>
  	
  	<select id="getUserById" parameterType="Integer" resultType="com.springboot.burgerking.domain.auth.User">
  		select
  			id,
			email,
			name,
			phone,
			gender,
			birth_year,
			birth_month,
			birth_date,
			password,
			create_date,
			update_date
  		from
  			user_mst
  		where
  			id = #{id}
  	</select>
  	
  	<select id="getUserId" resultType="Integer">
  		select id from user_mst order by id desc limit 1
  	</select>
  	
  	<insert id="signup" parameterType="com.springboot.burgerking.domain.auth.User">
  		insert into
  			user_mst
  		values(
  			0,
			#{email},
			null,
			#{name},
			#{phone},
			#{gender},
			#{birth_year},
			#{birth_month},
			#{birth_date},
			#{password},
			null,
			now(),
			now()
  		)
  	</insert>
  	
  	<update id="updatePhone" parameterType="com.springboot.burgerking.domain.auth.User">
  		update
  			user_mst
  		set
  			phone = #{phone}
  		where
  			email = #{email}
  	</update>
  	
  	<select id="getPhone" parameterType="String" resultType="String">
  		select
  			phone
  		from
  			user_mst
  		where
  			email=#{email}
  	</select>


  	
  </mapper>